<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LabWLBook - PDF Extractor</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <h1>üìÑ ‡πÅ‡∏õ‡∏•‡∏á PDF ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</h1>

        <form id="upload-form" action="/upload" method="post" enctype="multipart/form-data">
            <input type="file" name="pdf_files" multiple required>
            <button type="submit">üì§ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå</button>
        </form>

        <button id="process-btn">‚öôÔ∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</button>
        <p id="status">üïì ‡∏£‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô...</p>

        <h2>‚úÖ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß</h2>
        <ul id="file-list">
            {% for file in processed_files %}
            <li>{{ file }}</li>
            {% endfor %}
        </ul>

        <a href="/download_all" class="download-btn">‚¨áÔ∏è ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (.zip)</a>
    </div>

    <script>
        document.getElementById("process-btn").addEventListener("click", async () => {
            document.getElementById("status").textContent = "‚öôÔ∏è ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...";
            const res = await fetch("/process", { method: "POST" });
            const data = await res.json();

            if (data.status === "done") {
                document.getElementById("status").textContent = "‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!";
                const list = document.getElementById("file-list");
                list.innerHTML = "";
                data.processed_files.forEach(f => {
                    const li = document.createElement("li");
                    li.textContent = f;
                    list.appendChild(li);
                });
            }
        });
    </script>
</body>
</html>
